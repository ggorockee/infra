# Default values for go-scraper
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

enabled: true

image:
  repository: ggorockee/go-scraper
  pullPolicy: IfNotPresent
  tag: "latest"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels:
  job: go-scraper
  service: go-scraper

podSecurityContext: {}
securityContext: {}

resources:
  requests:
    cpu: 50m
    memory: 128Mi
  limits:
    cpu: 200m
    memory: 256Mi

nodeSelector: {}
tolerations: []
affinity: {}

configMap:
  enabled: true
  name: ""
  data:
    TIMEZONE: "Asia/Seoul"
    LOG_LEVEL: "info"
    SIGNOZ_ENDPOINT: "otel-collector.monitoring.svc.cluster.local:4318"
    SCRAPE_MAX_ITEMS: "0"  # 최대 수집 개수 (0 = 무제한)
    # Server API 연동 설정 (키워드 알림용)
    SERVER_API_BASE_URL: "http://reviewmaps-server:3000"
    SERVER_API_ENABLED: "true"

# ExternalSecret configuration (GCP Secret Manager)
externalSecret:
  enabled: true
  secretStore: "gcpsm-secret-store"
  secretKey: "prod-hotsao-credentials"
  targetSecretName: "prod-hotsao-credentials"
  refreshInterval: "1h"

# Secret configuration
secret:
  enabled: true
  names:
    - prod-hotsao-credentials

# CronJob configuration
runner:
  enabled: true
  scrapers:
    - name: reviewnote
      schedule: "0 2 * * *"  # 새벽 2시
      timeZone: "Asia/Seoul"
      concurrencyPolicy: "Forbid"
      startingDeadlineSeconds: 900
      successfulJobsHistoryLimit: 3
      failedJobsHistoryLimit: 5
      backoffLimit: 3
      ttlSecondsAfterFinished: 604800  # 1주일 (7일 * 24시간 * 3600초)
      keywords: []
      restartPolicy: "OnFailure"
    - name: inflexer
      schedule: "5 0 * * *"  # 00시 05분
      timeZone: "Asia/Seoul"
      concurrencyPolicy: "Forbid"
      startingDeadlineSeconds: 900
      successfulJobsHistoryLimit: 3
      failedJobsHistoryLimit: 5
      backoffLimit: 3
      ttlSecondsAfterFinished: 604800  # 1주일 (7일 * 24시간 * 3600초)
      keywords:
        # - "경기 김포"
        # 테스트 후 아래 주석 해제
        - "서울"
        - "경기 수원"
        - "경기 용인"
        - "경기 성남"
        - "경기 고양"
        - "경기 화성"
        - "경기 부천"
        - "경기 남양주"
        - "경기 안산"
        - "경기 안양"
        - "경기 평택"
        - "경기 시흥"
        - "경기 파주"
        - "경기 의정부"
        - "경기 광주"
        - "경기 광명"
        - "경기 군포"
        - "경기 하남"
        - "경기 오산"
        - "경기 이천"
        - "경기 안성"
        - "경기 의왕"
        - "경기 양평"
        - "경기 여주"
        - "경기 과천"
        - "경기 고양 일산"
        - "경기 구리"
        - "경기 포천"
        - "경기 동두천"
        - "경기 양주"
        - "부산"
        - "대구"
        - "인천"
        - "광주"
        - "대전"
        - "울산"
        - "세종"
        - "강원 춘천"
        - "강원 원주"
        - "강원 강릉"
        - "충북 청주"
        - "충남 천안"
        - "충남 아산"
        - "전북 전주"
        - "전북 익산"
        - "전남 순천"
        - "전남 여수"
        - "전남 목포"
        - "경북 포항"
        - "경북 경주"
        - "경북 구미"
        - "경남 창원"
        - "경남 김해"
        - "경남 진주"
        - "경남 양산"
        - "제주"
      restartPolicy: "OnFailure"

# Cleanup CronJob
cleanup:
  enabled: true
  schedule: "0 5 * * *"  # 새벽 5시
  timeZone: "Asia/Seoul"
  concurrencyPolicy: "Forbid"
  startingDeadlineSeconds: 1800
  successfulJobsHistoryLimit: 1
  failedJobsHistoryLimit: 3
  backoffLimit: 3
  ttlSecondsAfterFinished: 3600
  restartPolicy: "OnFailure"
