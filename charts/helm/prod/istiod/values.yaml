# Istio Control Plane (istiod) Configuration
# Chart: istio/istiod v1.28.1
# Reference: https://istio.io/latest/docs/setup/install/helm/

# Global settings for all Istio components
global:
  istioNamespace: istio-system

  # Image configuration
  hub: docker.io/istio
  tag: 1.28.1
  imagePullPolicy: IfNotPresent

  # Proxy sidecar configuration
  proxy:
    image: proxyv2
    autoInject: enabled
    clusterDomain: "cluster.local"
    logLevel: warning

    resources:
      requests:
        cpu: 100m
        memory: 128Mi
      limits:
        cpu: 2000m
        memory: 1024Mi

# Pilot (istiod) specific configuration
autoscaleEnabled: true
autoscaleMin: 1
autoscaleMax: 5
replicaCount: 1

resources:
  requests:
    cpu: 500m
    memory: 2048Mi

# Mesh configuration
meshConfig:
  enablePrometheusMerge: true

# Telemetry
telemetry:
  enabled: true
  v2:
    enabled: true
    prometheus:
      enabled: true
    stackdriver:
      enabled: false

# Sidecar injection
sidecarInjectorWebhook:
  enableNamespacesByDefault: false
  rewriteAppHTTPProbe: true

# Remote istiod configuration (for multi-cluster setups)
istiodRemote:
  enabled: false
  injectionPath: /inject
  injectionURL: ""
  injectionCABundle: ""
