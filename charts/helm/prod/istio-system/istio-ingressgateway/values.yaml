# Istio Ingress Gateway Configuration
# Reference: https://istio.io/latest/docs/setup/additional-setup/gateway/

# Global settings
global:
  # Hub is the container registry to pull from
  hub: docker.io/istio
  # Tag is the Istio version
  tag: 1.28.1

# Gateway selector labels - IMPORTANT for Gateway resources
labels:
  app: istio-ingressgateway
  istio: ingressgateway
  "istio.io/dataplane-mode": none

# Replica count
replicaCount: 2

# Service configuration
service:
  type: LoadBalancer
  ports:
  - name: status-port
    port: 15021
    protocol: TCP
    targetPort: 15021
  - name: http2
    port: 80
    protocol: TCP
    targetPort: 8080
  - name: https
    port: 443
    protocol: TCP
    targetPort: 8443

# Resource limits
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 2000m
    memory: 1024Mi

# Autoscaling configuration
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80

# Pod annotations for sidecar injection
podAnnotations:
  prometheus.io/port: "15020"
  prometheus.io/scrape: "true"
  prometheus.io/path: "/stats/prometheus"
  inject.istio.io/templates: "gateway"
  sidecar.istio.io/inject: "true"

# ServiceAccount
serviceAccount:
  create: true
  name: istio-ingressgateway
  annotations: {}

# RBAC
rbac:
  enabled: true

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1337
  runAsGroup: 1337
  fsGroup: 1337

containerSecurityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity rules
affinity: {}

# Pod disruption budget
podDisruptionBudget:
  minAvailable: 1

# Termination grace period
terminationGracePeriodSeconds: 30

# Environment variables
env: []

# Image pull policy
imagePullPolicy: IfNotPresent

# Network gateway
networkGateway: ""
