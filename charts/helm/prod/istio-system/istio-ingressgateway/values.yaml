# Istio Gateway (Ingress) Configuration
# Chart: istio/gateway v1.28.1
# Reference: https://istio.io/latest/docs/setup/additional-setup/gateway/

# Replica count (overridden by autoscaling when enabled)
replicaCount: 2

# Service Account
serviceAccount:
  create: true
  name: istio-ingressgateway
  annotations: {}

# Pod annotations for gateway injection
podAnnotations:
  prometheus.io/port: "15020"
  prometheus.io/scrape: "true"
  prometheus.io/path: "/stats/prometheus"
  inject.istio.io/templates: "gateway"
  sidecar.istio.io/inject: "true"

# Service configuration
service:
  type: LoadBalancer
  ports:
  - name: status-port
    port: 15021
    protocol: TCP
    targetPort: 15021
  - name: http2
    port: 80
    protocol: TCP
    targetPort: 80
  - name: https
    port: 443
    protocol: TCP
    targetPort: 443
  annotations: {}

# Resource limits
resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 2000m
    memory: 1024Mi

# Autoscaling configuration
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5
  targetCPUUtilizationPercentage: 80

# Pod environment variables (must be object, not array)
env: {}

# Labels for the gateway deployment
# IMPORTANT: These labels are used for Gateway resource selectors
labels:
  istio: ingressgateway
  app: istio-ingressgateway
  "istio.io/dataplane-mode": none

# Annotations for all resources
annotations: {}

# RBAC
rbac:
  enabled: true

# Security context
securityContext:
  runAsNonRoot: true
  runAsUser: 1337
  runAsGroup: 1337
  fsGroup: 1337

containerSecurityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity rules
affinity: {}

# Pod disruption budget
podDisruptionBudget:
  minAvailable: 1

# Termination grace period
terminationGracePeriodSeconds: 30

# Image pull policy
imagePullPolicy: IfNotPresent

# Network gateway (leave empty for default)
networkGateway: ""
